# Тестовое задание на  позицию стажера бекэнд разработчика.

Микросервис для динамического сегментирования пользователей

Реализованные задачи:
* Создание пользователя.
* Создание сегмента.
* Добавление пользователя в сегмент или несколько сегментов.
* Удаление пользователя из сегмента или нескольких сегментов.
* Получение списка сегментов, в которых состоит пользователь.
* Реализовано тестирование SQL запросов для сегментов и пользователей.


[//]: # (Немного команд примененных в ходе освоения docker.)

[//]: # (Добавление образа Postgres:)

[//]: # (`docker pull postgres`)

Запуск docker-compose:
`docker-compose up app`

[//]: # (Остановка контейнера: )

[//]: # (`docker stop <name>`)

Запуск миграций: 
`migrate -path ./schema -database 'postgres://avito:avito@localhost:5433/avito?sslmode=disable' up`

[//]: # (Вход в контейнер:)

[//]: # (`docker exec -it имя_контейнера /bin/bash`)

[//]: # (Открытие списка запущенных контейнеров:)

[//]: # (`docker ps`)

Сборка образа:
`docker build -t docker-avito .`

[//]: # (Подключение к терминалу Postgres:)

[//]: # (`psql -U avito`)

Примеры запросов:

(GET) /user/get-user-segment Метод получения списка сегментов пользователя
![img_5.png](img/img_5.png)

(POST) /user/create Метод создания пользователя
![img.png](img/img.png)

(POST) /user/add-segment Метод добавления сегмента пользователю
![img_3.png](img/img_3.png)

(DELETE) /user/delete-segment Метод удаление сегментов у пользователя
![img_4.png](img/img_4.png)

(GET) /segments/get-count-segment Метод получения количества пользователей для одного сегмента
![img_6.png](img/img_6.png)

(POST) /segments/create Метод создания сегмента
![img_2.png](img/img_2.png)

(DELETE) /segments/delete Метод удаления сегмента
![img_1.png](img/img_1.png)

(POST) segments/create Обновленный метод создания сегмента и добовление определенному проценту пользователей
![img.png](img/img7.png)



Вопросы, которые возникли в процессе выполнения:
* Метод добавления пользователя в сегмент. Принимает список slug (названий) сегментов которые нужно добавить пользователю, список slug (названий) сегментов которые нужно удалить у пользователя, id пользователя. Не совмсем понял это нужно сделать в один хендлер.

    `Решил вынести в два разных хендлера.`
* Так же решил добавить метод для получения количества пользователей в определенном сегменте. Возможно, для аналитики.

* В третьем дополнительном задании не указано в какую сторону округлять количество польователей. Так же не указано каких пользоватлей добавлять (с начала таблицы, с конца, рандомных).

  `Решил округлять в меньшую сторону. Пользователей беру с начала таблицы. Id пользователей получаю в слайсе, поэтому есть возможность менять направление записи.`